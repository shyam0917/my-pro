function Templater(){var e=this,t=0;this.blacklist=[],this.tmpl="",this.url="",this.id,this.data,this.content,this.mui,this.isThankPage=!1,this.lang="en",this.basePath="Employee-Training",this.previewImage="",this.defaultTab="Business",this.getRedirectUsers=function(){var e=$.Deferred();return $.get(config.APIUrl+"visitor/localsettings/",function(t){if(0!=t.response){var n=t.response,s=config.allowedCountries,i=n.ipInfo.country_code;-1==s.indexOf(i)&&window.location.replace("https://www.knowledgecity.com"),e.resolve({})}else window.location.replace("https://www.knowledgecity.com")}),e},this.getContent=function(){var t=$.Deferred(),n={url:this.getMainUrl()};return $.get(config.APIUrl+"landing/",n,function(n){if(0==n.response)return!1;var s=n.response;e.tmpl=s.template,e.content=s.content,e.mui=s.mui,e.id=s.id,t.resolve({})}).fail(function(e){}),t},this.runTemplate=function(t){return $.when(this.GetFeaturedCourses(),this.getClients(),this.getBlackList(),this.handleBenefits(),this.getTestimonials(),this.getCustomPreviewImage()).done(function(n,s,i,r,o){return $.when(e.getHeaderCourse(),e.setHeaderContent()).done(function(a){var c=e.content;if($.extend(c,n),$.extend(c,s),$.extend(c,o),$.extend(c,{isThankyouPage:e.isThankPage,headerCourse:a,mui:e.mui,benefits:r,template:"/"+e.basePath+"/"+e.tmpl+"/",landingPath:config.CDNPortal+"opencontent/landingpage/"+e.id+"/"}),c.additionalContentFlag){var d=e.handleAdditionalContent(c.additionalContentOrder);$.extend(c,d)}return $.when(e.renderTemplate(c,t)).done(function(){e.setOfflineConversionTracking(),e.blacklist="string"==typeof i[0]?$.parseJSON(i[0]):i[0]})})})},this.setupScripts=function(){var t=$.Deferred();return $("body").ready(function(){$("#mainContent").fadeIn(400,function(){e.setFeaturedCourses(),"onltraining"==e.tmpl&&$(".hero-slider").owlCarousel({loop:!0,autoplay:!0,autoplayTimeout:3e3,autoplayHoverPause:!0,items:1}),$.validator.addMethod("accepted_email",function(t,n){var s=t.toLowerCase().split("@");return!(e.blacklist.filter(function(e){if(e=="@"+s[1])return e}).length>0)},"Please use your Business Email"),$.validator.addMethod("validate_domain",function(e,t){var n=e.toLowerCase();if(2==n.split("@").length){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n))}return!1},"Please enter a valid email address"),$.validator.addMethod("numeric",function(e,t){return this.optional(t)||/^\d{10}$/.test(e)},"The phone number must be 10 digits"),$.validator.addMethod("alphanumericwith_spaces",function(e,t){return this.optional(t)||/^[a-z\d\s.&]+$/i.test(e)},"Please, use letters, numbers, and spaces only"),$("#number_employees").select2({placeholder:"Company Size*"}),$(".clients-slider").owlCarousel({loop:!0,nav:!1,center:!1,slideBy:"page",autoplay:!0,autoWidth:!1,responsiveRefreshRate:50,responsive:{0:{items:2},400:{items:3},700:{items:5},1150:{items:6}}}),$(".clients-wrapper .owl-nav__prev").on("click",function(){$(".clients-slider").trigger("prev.owl.carousel")}),$(".clients-wrapper .owl-nav__next").on("click",function(){$(".clients-slider").trigger("next.owl.carousel")}),$(".scroll.btn, .scroll").on("click",function(){var e=0;$('form#landing-form  input[name="name_f"]').length>0&&(e=$('form#landing-form input[name="name_f"]').offset().top-30),$("html, body").animate({scrollTop:e},800),$("form#landing-form input[name=name]").length>0&&$("form#landing-form input[name=name]").focus(),$('form#landing-form input[name="name_f"]').focus()}),$("form#landing-form").validate({onkeyup:!1,normalizer:function(e){return $.trim(e)},rules:{email:{required:!0,onkeyup:!1,accepted_email:!0,email:!0,validate_domain:!0},name_f:{required:!0,alphanumericwith_spaces:!0},company:{required:!0,alphanumericwith_spaces:!0},phone:{required:!0,maxlength:10,numeric:!0}},errorPlacement:function(e,t){e.appendTo($(t).parent())},showErrors:function(e,t){this.defaultShowErrors()},validClass:"valid",success:function(e){e.addClass("valid")},submitHandler:function(t,n){n.preventDefault();var s={type:"portals/www/marketing",content:{}};$('form#landing-form input[type="text"], form#landing-form input[type="email"], form#landing-form textarea').each(function(){var e=$(this).attr("name");s.content[e]=$(this).val()}),s.content[$("#number_employees").attr("name")]=$("#number_employees").select2().val(),s.content.landing_page=window.location.href,s.content.email_title=e.content.emailTitle,void 0!==e.content.source&&""!=e.content.source&&(s.content.source=e.content.source);var i="",r=$("#gclid_field").length>0?$("#gclid_field").val():"";r&&(i=window.location.href.split("?")[1],s.content.gclid=r);var o=config.APIUrl+"message/email";return $.post(o,s,function(t){if(1==t.response){var n=[location.protocol,"//",location.host,location.pathname].join(""),s="/"!=n.substr(n.length-1)?n+"/":"",r=void 0!==e.content.conversionPage?s+e.content.conversionPage:s+"thankyou.html";i&&(r=r+"?"+i),window.location.href=r}}),!1}}),$("#number_employees").on("select2:select",function(e){$(this).valid()}),$(".featured-course a, .preview-item a").on("click",function(e){e.preventDefault();var t=e.currentTarget;(new PreviewModal).show($(t).data("course-id"),$(t).data("lessonid"))}),void 0!==e.content.isMultipleCategories&&1==e.content.isMultipleCategories&&$("button.tablinks").on("click",function(){if(!$(this).hasClass("active")){$("button.tablinks").removeClass("active"),$(this).addClass("active");var t=$(this).data("library");$(".tabcontent").css("display","none"),$("#"+t).css("display","block")}e.defaultTab=this.attributes["data-library"].value;var n=$("."+e.defaultTab+"0");n.length>0?($("span.viewMore").removeClass("hidden"),$("span.viewLess").addClass("hidden"),n.addClass("hidden"),$(".show-hide-btn").removeClass("hidden")):$(".show-hide-btn").addClass("hidden")}),$("span.viewMore").on("click",function(){$("."+e.defaultTab+"0").removeClass("hidden"),$("span.viewMore").addClass("hidden"),$("span.viewLess").removeClass("hidden")}),$("span.viewLess").on("click",function(){$("html, body").animate({scrollTop:1800}),$("."+e.defaultTab+"0").addClass("hidden"),$("span.viewLess").addClass("hidden"),$("span.viewMore").removeClass("hidden")}),e.runTestimonials(),t.resolve({})})}),t},this.handleAdditionalContent=function(e){var t,n=[],s="even"==(null!=e?e:"even")?"beforeContent":"afterContent";"beforeContent"==s?n.beforeContent=!0:n.afterContent=!0;var i=this.mui.additionalContent.length;return t=$.map(this.mui.additionalContent,function(e,t){var n="";return"even"==(n="beforeContent"==s?i%2==0?t%2==0?"odd":"even":t%2==0?"even":"odd":t%2==0?"odd":"even")?(e.isEven=!0,e.alignOrder=n):(e.isOdd=!0,e.alignOrder=n,e.bgClass="gray-bg"),e.alignOrder=n,e}),n.additionalContent=t,n},this.handleBenefits=function(){var e,t=$.Deferred();return e=$.map(this.mui.benefits,function(e,t){return e}),t.resolve(e),t},this.getMainUrl=function(){var t=window.location.href.split("/"),n=t.indexOf(this.basePath),s=(t=(t=$.grep(t,function(t){return t.lastIndexOf("thankyou.html")>=0?(e.isThankPage=!0,!1):""!=t})).slice(n)).join("/").toLowerCase().split("?");return this.url=s[0],this.url},this.getConfig=function(){var e=$.Deferred();return $.get("/js/overrideConfig.json",function(t){var n="string"==typeof t?$.parseJSON(t):t;$.extend(config,n),e.resolve(config)}),e},this.getClients=function(){var t=$.Deferred();return $.get("https://staticcontent.knowledgecity.com/templates/ussite/1.0/json/clients--v"+config.LocalStorageStamp+".json",function(n){var s=n;"string"==typeof s&&(s=$.parseJSON(n)),"libraries"===e.getMainUrl()&&s.sort(function(e,t){return e.orderFlag&&!t.orderFlag?-1:!e.orderFlag&&t.orderFlag?1:0});var i={};i.clients=s.map(function(e){return{client:'<div class="index-client"><img class="index-client__img" src="https://staticcontent.knowledgecity.com/templates/ussite/1.0/images/clients/logos/'+e.name+"--v"+config.LocalStorageStamp+'.png"></div>'}}),t.resolve(i)}),t},this.getTemplate=function(){var e=$.Deferred();return $.when(this.getHTML("/"+this.basePath+"/"+this.tmpl+"/index.mst")).done(function(t){e.resolve(t)}),e},this.setHeaderContent=function(){return headerProm=$.Deferred(),e.content.noCDN||$("head").append('<link rel="stylesheet" href="'+config.CDNPortal+"opencontent/landingpage/"+e.id+'/assets/css/style.css" />'),$("head title").html(this.content.title),$("head").append(this.setMetaData()),$("head").append(this.setStyles()),$("head").append(this.setAnalyticsCode()),headerProm.resolve({})},this.getHTML=function(e){var t=$.Deferred();return $.get(e,function(e){t.resolve(e)}),t},this.GetFeaturedCourses=function(){var e=$.Deferred(),t={};if(void 0!==this.content.featuredCourses){var n=this.content.featuredCourses;"string"==typeof n&&(n=$.parseJSON(res)),this.content.isMultipleCategories,t=1==this.content.isMultipleCategories?this.getMultipleCategoriesCourses(n):this.getSingleCategoryCourses(n)}return e.resolve(t),e},this.getSingleCategoryCourses=function(t){var n={};return n.courses=t.courses.map(function(t){var n={title:t.course_title,url:"https://www.knowledgecity.com/en/library/"+t.course_id+"/"+e.generateUrl(t.course_title),course_id:t.course_id,lesson_id:t.firstLesson_guid,preview:{path:"https://cdn0.knowledgecity.com/opencontent/courses/previews/",src:t.course_id+"/400.jpg",src2x:t.course_id+"/800.jpg",sources:[{maxWidth:395,src:t.course_id+"/400.jpg",src2x:t.course_id+"/800.jpg"},{maxWidth:600,src:t.course_id+"/640.jpg",src2x:t.course_id+"/1280.jpg"}]},runtime:e.formatSecondsToHrs(t.trt),lesson_type:t.introType||"video"},s="";return"featured-course"==e.content.typeFeatured&&(s=e.buildFeaturedCourse(n)),"preview-item"==e.content.typeFeatured&&(s=e.buildprevewItem(n)),s}),n},this.getMultipleCategoriesCourses=function(t){var n={tabs:[],courses:[]},s=/\s+/gi;return t.map(function(t,i){n.tabs[t.order]='<button class="tablinks',0==t.order&&(n.tabs[t.order]+=" active");let r=t.tab;r.trim().replace(s," ").split(" ").length>1&&(r=r.trim().replace(s,"_")),n.tabs[t.order]+='" data-library="'+r+'">'+t.tab+"</button>";var o=t.courses.map(function(t,n){var s={title:t.course_title,url:"https://www.knowledgecity.com/en/library/"+t.course_id+"/"+e.generateUrl(t.course_title),course_id:t.course_id,lesson_id:t.firstLesson_guid,preview:{path:"https://cdn0.knowledgecity.com/opencontent/courses/previews/",src:t.course_id+"/400.jpg",src2x:t.course_id+"/800.jpg",sources:[{maxWidth:395,src:t.course_id+"/400.jpg",src2x:t.course_id+"/800.jpg"},{maxWidth:600,src:t.course_id+"/640.jpg",src2x:t.course_id+"/1280.jpg"}]},runtime:e.formatSecondsToHrs(t.trt),lesson_type:t.introType||"video"},i="",o=e.getHideClassName(n,r);return"featured-course"==e.content.typeFeatured&&(i=e.buildFeaturedCourse(s,o)),"preview-item"==e.content.typeFeatured&&(i=e.buildprevewItem(s)),i}).join("");n.courses[t.order]='<div id="'+r+'" class="tabcontent inner-tab__business" style="display: ',0==t.order?n.courses[t.order]+="block;":n.courses[t.order]+="none;",n.courses[t.order]+='"><div class="inner-tab_copy">'+o+"</div></div>"}),n},this.getHideClassName=function(e,t){return e<=15?"":t+0+" hidden"},this.buildFeaturedCourse=function(e,t=""){return retcourse='<div class="featured-course '+t+'"><a href="'+e.url+'" data-course-id="'+e.course_id+'" target="_blank" data-lessonid="'+e.lesson_id+'" data-lesson-type="'+e.lesson_type+'" class="featured-course__link"><picture class="course-video__preview-img">',$.each(e.preview.sources,function(){retcourse+='<source media="(max-width: '+this.maxWidth+'px)"srcset="'+e.preview.path+this.src+", "+e.preview.path+this.src2x+' 2x">'}),retcourse+='<img src="'+e.preview.path+e.preview.src+'"srcset="'+e.preview.path+e.preview.src+", "+e.preview.path+e.preview.src2x+' 2x" alt=""></picture></a><div class="featured-course__footer"><a class="featured-course__title" href="'+e.url+'" data-course-id="'+e.course_id+'" data-lessonid="'+e.lesson_id+'" data-lesson-type="'+e.lesson_type+'" >'+e.title+'</a><span class="featured-course__runtime">'+e.runtime+"</span></div></div>",retcourse},this.buildprevewItem=function(e){var t='<div class="preview-item"><a href="'+e.url+'" data-course-id="'+e.course_id+'" target="_blank" data-lessonid="'+e.lesson_id+'" data-lesson-type="'+e.lesson_type+'" class="preview-item__href"><picture class="course-video__preview-img">';return $.each(e.preview.sources,function(){t+='<source media="(max-width: '+this.maxWidth+'px)"srcset="'+e.preview.path+this.src+", "+e.preview.path+this.src2x+' 2x">'}),t+='<img src="'+e.preview.path+e.preview.src+'"srcset="'+e.preview.path+e.preview.src+", "+e.preview.path+e.preview.src2x+' 2x" alt=""></picture></a><div class="preview-item__footer"><a href="'+e.url+'" data-course-id="'+e.course_id+'" data-lessonid="'+e.lesson_id+'" data-lesson-type="'+e.lesson_type+'" >'+e.title+"</a></div></div>"},this.getHeaderCourse=function(){var t=$.Deferred(),n={};if(void 0!==this.content.isHeaderCourse&&0!=this.content.isHeaderCourse){var s=e.content.headerCourse;"string"==typeof s&&(s=$.parseJSON(res)),n=s.courses.map(function(t){t.course_title;var n="https://www.knowledgecity.com/en/library/"+t.course_id+"/"+e.generateUrl(t.course_title),s=t.course_id,i=t.firstLesson_guid,r=(t.course_id,e.formatSecondsToHrs(t.trt),'<div class="preview-item"><a href="'+n+'" data-course-id="'+s+'" target="_blank" data-lessonid="'+i+'" data-lesson-type="'+(t.introType||"video")+'" class="preview-item__href"><picture class="course-video__preview-img">');return r+='<img src="'+e.previewImage+'" alt=""/></picture></a></div>'}),t.resolve(n)}else t.resolve(n);return t},this.getCustomPreviewImage=function(){var t=$.Deferred();return this.previewImage="/"+this.basePath+"/"+this.tmpl+"/images/CoursePreview.JPG",void 0!==this.content.headerCourseImage&&""!=this.content.headerCourseImage?$.ajax({url:config.CDNPortal+"opencontent/landingpage/"+this.id+"/assets/images/"+this.content.headerCourseImage,type:"HEAD",error:function(){t.resolve({image:e.previewImage})},success:function(){e.previewImage=config.CDNPortal+"opencontent/landingpage/"+e.id+"/assets/images/"+e.content.headerCourseImage,t.resolve({image:e.previewImage})}}):t.resolve({image:e.previewImage}),t},this.getBlackList=function(){return $.ajax({url:"/"+this.basePath+"/shared/json/emailcompanyblacklist.json",cache:!1,dataType:"json"})},this.generateUrl=function(e){return e.replace(/\ /g,"-").toLowerCase()},this.formatSecondsToHrs=function(e){var t=e/3600^0,n=(e-3600*t)/60^0;return t+"hrs. "+(n=n<10?"0"+n:n)+"min."},this.runTestimonials=function(){0!=t&&clearTimeout(t),t=setInterval(function(){var t=$(".dot-wrapper").find(".activo"),n=t.parent().index();$(".dot-wrapper").find(".dot.slideshow-dot").removeClass("activo"),t.length>0&&n<$(".dot-wrapper").children().length-1?(n++,$(".dot-wrapper").children(".full-slide-wrapper ").eq(n).find(".dot.slideshow-dot").addClass("activo")):$(".dot-wrapper").children().first().find(".dot.slideshow-dot").addClass("activo"),e.runTestimonials()},3e4),$(".dot.slideshow-dot").off("click").on("click",function(){$(".dot-wrapper").find(".dot.slideshow-dot").removeClass("activo"),$(this).addClass("activo"),e.runTestimonials()})},this.renderTemplate=function(t,n){var s=$.Deferred(),i=Mustache.render(n,t);return $("#mainContent").html(i),$(".preload").fadeOut(400,function(){$(".preload").remove(),$("body style").remove(),$("body").removeAttr("style"),e.setupScripts()}),s.resolve({}),s},this.setFeaturedCourses=function(e){void 0!==this.content.activateCarousel&&1==this.content.activateCarousel&&($("#featuredCourses").owlCarousel({loop:!0,nav:!1,center:!1,slideBy:"page",autoplay:!0,autoWidth:!1,responsiveRefreshRate:50,responsive:{300:{items:1},600:{items:2},1200:{items:3},1500:{items:4}}}),$(".landing-featured-courses .owl-controls__prev").on("click",function(){$("#featuredCourses").trigger("prev.owl.carousel")}),$(".landing-featured-courses .owl-controls__next").on("click",function(){$("#featuredCourses").trigger("next.owl.carousel")}))},this.getTestimonials=function(){var e=$.Deferred();return $.get("https://staticcontent.knowledgecity.com/templates/ussite/1.0/json/en-testimonials--v"+config.LocalStorageStamp+".json",function(t){var n={};n.testimonials=t.map(function(e){e.image=e.image.split(".").join("--v"+config.LocalStorageStamp+".");var t='<div class="full-slide-wrapper"><div class="dot slideshow-dot fade ';return void 0!==e.class&&(t+=e.class),t+='" style="background-image:url(https://staticcontent.knowledgecity.com/templates/ussite/1.0/images/clients/testimonials/'+e.image+')"></div><div class="slide-wrapper fade"><div class="slide-content-wrapper"><div class="slide-text">"'+e.text+'"</div><div class="slide-owner-wrapper"><div class="slide-owner">'+e.name+'</div><div class="slide-owner-info">'+e.title,void 0!==e.company&&(t+=" | "+e.company),{testimonial:t+="</div></div></div></div></div>"}}),e.resolve(n)}),e},this.setAnalyticsCode=function(){var e="";return this.isThankPage&&void 0!==this.content.conversionCode&&(e+='<script async src="https://www.googletagmanager.com/gtag/js?id='+this.content.conversionCode+"\"><\/script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '"+this.content.conversionCode+"'); <\/script>"),void 0!==this.content.analyticsCode&&(e+='<script async src="https://www.googletagmanager.com/gtag/js?id='+this.content.analyticsCode+"\"><\/script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '"+this.content.analyticsCode+"');<\/script>"),this.isThankPage&&void 0!==this.content.conversionTag&&(e+="<script> gtag('event', 'conversion', {'send_to': '"+this.content.conversionCode+"/"+this.content.conversionTag+"'}); <\/script>"),void 0!==this.content.isFacebookPixel&&1==this.content.isFacebookPixel&&(e+="\x3c!-- Facebook Pixel Code --\x3e<script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init', '1926496504263076');fbq('track', 'PageView');"+'<\/script><noscript><img height="1" width="1"src="https://www.facebook.com/tr?id=1926496504263076&ev=PageView&noscript=1"/></noscript>\x3c!-- End Facebook Pixel Code --\x3e'),this.isThankPage&&void 0!==this.content.bingCode&&(e+='<script defer>(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"'+this.content.bingCode+'"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq");<\/script>'),void 0!==this.content.gtagCode&&(e+='<script defer src="https://www.googletagmanager.com/gtag/js?id='+this.content.gtagCode+"\"><\/script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', '"+this.content.gtagCode+"');<\/script>"),e},this.setMetaData=function(){var e="";return void 0!==this.content.meta&&$.each(this.content.meta,function(t,n){e+='<meta name="'+t+'" content="'+n+'">'}),e},this.setStyles=function(){var e="";return"corptraining"==this.tmpl&&(e+='<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" />'),e+='<link rel="stylesheet" href="/'+this.basePath+"/"+this.tmpl+'/css/style.min.css" /><link rel="stylesheet" href="/'+this.basePath+"/"+this.tmpl+'/css/responsive.min.css" />'},this.getParam=function(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))},this.getExpiryRecord=function(e){return{value:e,expiryDate:(new Date).getTime()+7776e6}},this.addGclid=function(){var t,n=e.getParam("gclid"),s=null,i=e.getParam("gclsrc"),r=!i||-1!==i.indexOf("aw");["gclid_field"].forEach(function(e){document.getElementById(e)&&(t=document.getElementById(e))}),n&&r&&(s=e.getExpiryRecord(n),localStorage.setItem("gclid",JSON.stringify(s)));var o=s||JSON.parse(localStorage.getItem("gclid")),a=o&&(new Date).getTime()<o.expiryDate;t&&a&&(t.value=o.value)},this.setOfflineConversionTracking=function(){var t=$.Deferred();return e.addGclid(),t.resolve({}),t}}
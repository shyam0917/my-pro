function Templater(){var a=this,b=0;this.blacklist=[],this.tmpl="",this.url="",this.id,this.data,this.content,this.mui,this.isThankPage=!1,this.lang="en",this.basePath="Employee-Training",this.previewImage="",this.getRedirectUsers=function(){var a=$.Deferred();return $.get(config.APIUrl+"visitor/localsettings/",function(b){if(!1!=b.response){var c=b.response,d=config.allowedCountries,e=c.ipInfo.country_code;-1==d.indexOf(e)&&window.location.replace("https://www.knowledgecity.com"),a.resolve({})}else window.location.replace("https://www.knowledgecity.com")}),a},this.getContent=function(){var b=$.Deferred(),c=this.getMainUrl();return $.get(config.APIUrl+"landing/",{url:c},function(c){if(!1!=c.response){var d=c.response;a.tmpl=d.template,a.content=d.content,a.mui=d.mui,a.id=d.id,b.resolve({})}else return!1}).fail(function(){}),b},this.runTemplate=function(b){return $.when(this.GetFeaturedCourses(),this.getClients(),this.getBlackList(),this.handleBenefits(),this.getTestimonials(),this.getCustomPreviewImage()).done(function(c,d,e,f,g){return $.when(a.getHeaderCourse(),a.setHeaderContent()).done(function(h){var i=a.content;if($.extend(i,c),$.extend(i,d),$.extend(i,g),$.extend(i,{isThankyouPage:a.isThankPage,headerCourse:h,mui:a.mui,benefits:f,template:"/"+a.basePath+"/"+a.tmpl+"/",landingPath:config.CDNPortal+"opencontent/landingpage/"+a.id+"/"}),i.additionalContentFlag){var j=a.handleAdditionalContent(i.additionalContentOrder);$.extend(i,j)}return $.when(a.renderTemplate(i,b)).done(function(){a.setOfflineConversionTracking(),a.blacklist="string"==typeof e[0]?$.parseJSON(e[0]):e[0]})})})},this.setupScripts=function(){var b=$.Deferred();return $("body").ready(function(){$("#mainContent").fadeIn(400,function(){a.setFeaturedCourses(),"onltraining"==a.tmpl&&$(".hero-slider").owlCarousel({loop:!0,autoplay:!0,autoplayTimeout:3e3,autoplayHoverPause:!0,items:1}),$.validator.addMethod("accepted_email",function(b){var c=b.toLowerCase(),d=c.split("@"),e=a.blacklist.filter(function(a){if(a=="@"+d[1])return a});return!(0<e.length)},"Please use your Business Email"),$.validator.addMethod("validate_domain",function(a){var b=a.toLowerCase(),c=b.split("@");if(2==c.length){var d=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e=d.test(b+"");return e}return!1},"Please enter a valid email address"),$.validator.addMethod("numeric",function(a,b){return this.optional(b)||/^\d{10}$/.test(a)},"The phone number must be 10 digits"),$.validator.addMethod("alphanumericwith_spaces",function(a,b){return this.optional(b)||/^[a-z\d\s.&]+$/i.test(a)},"Please, use letters, numbers, and spaces only"),$("#number_employees").select2({placeholder:"Company Size*"}),$(".clients-slider").owlCarousel({loop:!0,nav:!1,center:!1,slideBy:"page",autoplay:!0,autoWidth:!1,responsiveRefreshRate:50,responsive:{0:{items:2},400:{items:3},700:{items:5},1150:{items:6}}}),$(".clients-wrapper .owl-nav__prev").on("click",function(){$(".clients-slider").trigger("prev.owl.carousel")}),$(".clients-wrapper .owl-nav__next").on("click",function(){$(".clients-slider").trigger("next.owl.carousel")}),$(".scroll.btn, .scroll").on("click",function(){var a=0;0<$("form#landing-form  input[name=\"name_f\"]").length&&(a=$("form#landing-form input[name=\"name_f\"]").offset().top-30),$("html, body").animate({scrollTop:a},800),0<$("form#landing-form input[name=name]").length&&$("form#landing-form input[name=name]").focus(),$("form#landing-form input[name=\"name_f\"]").focus()}),$("form#landing-form").validate({onkeyup:!1,normalizer:function(a){return $.trim(a)},rules:{email:{required:!0,onkeyup:!1,accepted_email:!0,email:!0,validate_domain:!0},name_f:{required:!0,alphanumericwith_spaces:!0},company:{required:!0,alphanumericwith_spaces:!0},phone:{required:!0,maxlength:10,numeric:!0}},errorPlacement:function(a,b){a.appendTo($(b).parent())},showErrors:function(){this.defaultShowErrors()},validClass:"valid",success:function(a){a.addClass("valid")},submitHandler:function(b,c){c.preventDefault();var d={};d.type="portals/www/marketing",d.content={},$("form#landing-form input[type=\"text\"], form#landing-form input[type=\"email\"], form#landing-form textarea").each(function(){var a=$(this).attr("name");d.content[a]=$(this).val()}),d.content[$("#number_employees").attr("name")]=$("#number_employees").select2().val(),d.content.landing_page=window.location.href,d.content.email_title=a.content.emailTitle,"undefined"!=typeof a.content.source&&""!=a.content.source&&(d.content.source=a.content.source);var e="",f=0<$("#gclid_field").length?$("#gclid_field").val():"";f&&(e=window.location.href.split("?")[1],d.content.gclid=f);var g=config.APIUrl+"message/email";return $.post(g,d,function(b){if(!0==b.response){var c=[location.protocol,"//",location.host,location.pathname].join(""),d="/"==c.substr(c.length-1)?"":c+"/",f="undefined"==typeof a.content.conversionPage?d+"thankyou.html":d+a.content.conversionPage;e&&(f=f+"?"+e),window.location.href=f}}),!1}}),$("#number_employees").on("select2:select",function(){$(this).valid()}),$(".featured-course a, .preview-item a").on("click",function(a){a.preventDefault();var b=a.currentTarget,c=new PreviewModal;c.show($(b).data("course-id"),$(b).data("lessonid"))}),"undefined"!=typeof a.content.isMultipleCategories&&!0==a.content.isMultipleCategories&&$("button.tablinks").on("click",function(){if(!$(this).hasClass("active")){$("button.tablinks").removeClass("active"),$(this).addClass("active");var a=$(this).data("library");$(".tabcontent").css("display","none"),$("#"+a).css("display","block")}}),a.runTestimonials(),b.resolve({})})}),b},this.handleAdditionalContent=function(a){var b=[],c=[],d=null==a?"even":a,e="even"==d?"beforeContent":"afterContent";"beforeContent"==e?b.beforeContent=!0:b.afterContent=!0;var f=this.mui.additionalContent.length;return c=$.map(this.mui.additionalContent,function(a,b){var c="";return c="beforeContent"==e?0==f%2?0==b%2?"odd":"even":0==b%2?"even":"odd":0==b%2?"odd":"even","even"==c?(a.isEven=!0,a.alignOrder=c):(a.isOdd=!0,a.alignOrder=c,a.bgClass="gray-bg"),a.alignOrder=c,a}),b.additionalContent=c,b},this.handleBenefits=function(){var a=$.Deferred(),b=[];return b=$.map(this.mui.benefits,function(a){return a}),a.resolve(b),a},this.getMainUrl=function(){var b=window.location.href.split("/"),c=b.indexOf(this.basePath);b=$.grep(b,function(b){return 0<=b.lastIndexOf("thankyou.html")?(a.isThankPage=!0,!1):""!=b}),b=b.slice(c);var d=b.join("/").toLowerCase().split("?");return this.url=d[0],this.url},this.getConfig=function(){var a=$.Deferred();return $.get("/js/overrideConfig.json",function(b){var c="string"==typeof b?$.parseJSON(b):b;$.extend(config,c),a.resolve(config)}),a},this.getClients=function(){var b=$.Deferred();return $.get("https://staticcontent.knowledgecity.com/templates/ussite/1.0/json/clients--v"+config.LocalStorageStamp+".json",function(c){var d=c;"string"==typeof d&&(d=$.parseJSON(c));var e=a.getMainUrl();"libraries"===e&&d.sort(function(c,a){return c.orderFlag&&!a.orderFlag?-1:!c.orderFlag&&a.orderFlag?1:0});var f={};f.clients=d.map(function(a){let b="<div class=\"index-client\"><img class=\"index-client__img\" src=\"https://staticcontent.knowledgecity.com/templates/ussite/1.0/images/clients/logos/"+a.name+"--v"+config.LocalStorageStamp+".png\"></div>";return{client:b}}),b.resolve(f)}),b},this.getTemplate=function(){var a=$.Deferred();return $.when(this.getHTML("/"+this.basePath+"/"+this.tmpl+"/index.mst")).done(function(b){a.resolve(b)}),a},this.setHeaderContent=function(){return headerProm=$.Deferred(),a.content.noCDN||$("head").append("<link rel=\"stylesheet\" href=\""+config.CDNPortal+"opencontent/landingpage/"+a.id+"/assets/css/style.css\" />"),$("head title").html(this.content.title),$("head").append(this.setMetaData()),$("head").append(this.setStyles()),$("head").append(this.setAnalyticsCode()),headerProm.resolve({})},this.getHTML=function(a){var b=$.Deferred();return $.get(a,function(a){b.resolve(a)}),b},this.GetFeaturedCourses=function(){var a=$.Deferred(),b={};if("undefined"!=typeof this.content.featuredCourses){var c=this.content.featuredCourses;"string"==typeof c&&(c=$.parseJSON(res)),b=typeof this.content.isMultipleCategories&&!0==this.content.isMultipleCategories?this.getMultipleCategoriesCourses(c):this.getSingleCategoryCourses(c)}return a.resolve(b),a},this.getSingleCategoryCourses=function(b){var c={courses:b.courses.map(function(b){var c={title:b.course_title,url:"https://www.knowledgecity.com/en/library/"+b.course_id+"/"+a.generateUrl(b.course_title),course_id:b.course_id,lesson_id:b.firstLesson_guid,preview:{path:"https://cdn0.knowledgecity.com/opencontent/courses/previews/",src:b.course_id+"/400.jpg",src2x:b.course_id+"/800.jpg",sources:[{maxWidth:395,src:b.course_id+"/400.jpg",src2x:b.course_id+"/800.jpg"},{maxWidth:600,src:b.course_id+"/640.jpg",src2x:b.course_id+"/1280.jpg"}]},runtime:a.formatSecondsToHrs(b.trt),lesson_type:b.introType||"video"},d="";return"featured-course"==a.content.typeFeatured&&(d=a.buildFeaturedCourse(c)),"preview-item"==a.content.typeFeatured&&(d=a.buildprevewItem(c)),d})};return c},this.getMultipleCategoriesCourses=function(b){var c={tabs:[],courses:[]},d=/\s+/gi;return b.map(function(b){c.tabs[b.order]="<button class=\"tablinks",0==b.order&&(c.tabs[b.order]+=" active");let e=b.tab,f=e.trim().replace(d," ").split(" ").length;1<f&&(e=e.trim().replace(d,"_")),c.tabs[b.order]+="\" data-library=\""+e+"\">"+b.tab+"</button>";var g=b.courses.map(function(b){var c={title:b.course_title,url:"https://www.knowledgecity.com/en/library/"+b.course_id+"/"+a.generateUrl(b.course_title),course_id:b.course_id,lesson_id:b.firstLesson_guid,preview:{path:"https://cdn0.knowledgecity.com/opencontent/courses/previews/",src:b.course_id+"/400.jpg",src2x:b.course_id+"/800.jpg",sources:[{maxWidth:395,src:b.course_id+"/400.jpg",src2x:b.course_id+"/800.jpg"},{maxWidth:600,src:b.course_id+"/640.jpg",src2x:b.course_id+"/1280.jpg"}]},runtime:a.formatSecondsToHrs(b.trt),lesson_type:b.introType||"video"},d="";return"featured-course"==a.content.typeFeatured&&(d=a.buildFeaturedCourse(c)),"preview-item"==a.content.typeFeatured&&(d=a.buildprevewItem(c)),d}),h=g.join("");c.courses[b.order]="<div id=\""+e+"\" class=\"tabcontent inner-tab__business\" style=\"display: ",c.courses[b.order]+=0==b.order?"block;":"none;",c.courses[b.order]+="\"><div class=\"inner-tab_copy\">"+h+"</div></div>"}),c},this.buildFeaturedCourse=function(a){return retcourse="<div class=\"featured-course\"><a href=\""+a.url+"\" data-course-id=\""+a.course_id+"\" target=\"_blank\" data-lessonid=\""+a.lesson_id+"\" data-lesson-type=\""+a.lesson_type+"\" class=\"featured-course__link\"><picture class=\"course-video__preview-img\">",$.each(a.preview.sources,function(){retcourse+="<source media=\"(max-width: "+this.maxWidth+"px)\"srcset=\""+a.preview.path+this.src+", "+a.preview.path+this.src2x+" 2x\">"}),retcourse+="<img src=\""+a.preview.path+a.preview.src+"\"srcset=\""+a.preview.path+a.preview.src+", "+a.preview.path+a.preview.src2x+" 2x\" alt=\"\"></picture></a><div class=\"featured-course__footer\"><a class=\"featured-course__title\" href=\""+a.url+"\" data-course-id=\""+a.course_id+"\" data-lessonid=\""+a.lesson_id+"\" data-lesson-type=\""+a.lesson_type+"\" >"+a.title+"</a><span class=\"featured-course__runtime\">"+a.runtime+"</span></div></div>",retcourse},this.buildprevewItem=function(a){var b="<div class=\"preview-item\"><a href=\""+a.url+"\" data-course-id=\""+a.course_id+"\" target=\"_blank\" data-lessonid=\""+a.lesson_id+"\" data-lesson-type=\""+a.lesson_type+"\" class=\"preview-item__href\"><picture class=\"course-video__preview-img\">";return $.each(a.preview.sources,function(){b+="<source media=\"(max-width: "+this.maxWidth+"px)\"srcset=\""+a.preview.path+this.src+", "+a.preview.path+this.src2x+" 2x\">"}),b+="<img src=\""+a.preview.path+a.preview.src+"\"srcset=\""+a.preview.path+a.preview.src+", "+a.preview.path+a.preview.src2x+" 2x\" alt=\"\"></picture></a><div class=\"preview-item__footer\"><a href=\""+a.url+"\" data-course-id=\""+a.course_id+"\" data-lessonid=\""+a.lesson_id+"\" data-lesson-type=\""+a.lesson_type+"\" >"+a.title+"</a></div></div>",b},this.getHeaderCourse=function(){var b=$.Deferred(),c={};if("undefined"!=typeof this.content.isHeaderCourse&&!1!=this.content.isHeaderCourse){var d=a.content.headerCourse;"string"==typeof d&&(d=$.parseJSON(res)),c=d.courses.map(function(b){var c={title:b.course_title,url:"https://www.knowledgecity.com/en/library/"+b.course_id+"/"+a.generateUrl(b.course_title),course_id:b.course_id,lesson_id:b.firstLesson_guid,preview:{path:"https://cdn0.knowledgecity.com/opencontent/courses/previews/",src:b.course_id+"/1280.jpg"},runtime:a.formatSecondsToHrs(b.trt),lesson_type:b.introType||"video"},d="<div class=\"preview-item\"><a href=\""+c.url+"\" data-course-id=\""+c.course_id+"\" target=\"_blank\" data-lessonid=\""+c.lesson_id+"\" data-lesson-type=\""+c.lesson_type+"\" class=\"preview-item__href\"><picture class=\"course-video__preview-img\">";return d+="<img src=\""+a.previewImage+"\" alt=\"\"/></picture></a></div>",d}),b.resolve(c)}else b.resolve(c);return b},this.getCustomPreviewImage=function(){var b=$.Deferred();return this.previewImage="/"+this.basePath+"/"+this.tmpl+"/images/CoursePreview.JPG","undefined"!=typeof this.content.headerCourseImage&&""!=this.content.headerCourseImage?$.ajax({url:config.CDNPortal+"opencontent/landingpage/"+this.id+"/assets/images/"+this.content.headerCourseImage,type:"HEAD",error:function(){b.resolve({image:a.previewImage})},success:function(){a.previewImage=config.CDNPortal+"opencontent/landingpage/"+a.id+"/assets/images/"+a.content.headerCourseImage,b.resolve({image:a.previewImage})}}):b.resolve({image:a.previewImage}),b},this.getBlackList=function(){return $.ajax({url:"/"+this.basePath+"/shared/json/emailcompanyblacklist.json",cache:!1,dataType:"json"})},this.generateUrl=function(a){return a.replace(/\ /g,"-").toLowerCase()},this.formatSecondsToHrs=function(a){var b=0^a/3600,c=0^(a-3600*b)/60;return c=10>c?"0"+c:c,b+"hrs. "+c+"min."},this.runTestimonials=function(){0!=b&&clearTimeout(b),b=setInterval(function(){var b=$(".dot-wrapper").find(".activo"),c=b.parent().index();$(".dot-wrapper").find(".dot.slideshow-dot").removeClass("activo"),0<b.length?c<$(".dot-wrapper").children().length-1?(c++,$(".dot-wrapper").children(".full-slide-wrapper ").eq(c).find(".dot.slideshow-dot").addClass("activo")):$(".dot-wrapper").children().first().find(".dot.slideshow-dot").addClass("activo"):$(".dot-wrapper").children().first().find(".dot.slideshow-dot").addClass("activo"),a.runTestimonials()},3e4),$(".dot.slideshow-dot").off("click").on("click",function(){$(".dot-wrapper").find(".dot.slideshow-dot").removeClass("activo"),$(this).addClass("activo"),a.runTestimonials()})},this.renderTemplate=function(b,c){var d=$.Deferred(),e=Mustache.render(c,b);return $("#mainContent").html(e),$(".preload").fadeOut(400,function(){$(".preload").remove(),$("body style").remove(),$("body").removeAttr("style"),a.setupScripts()}),d.resolve({}),d},this.setFeaturedCourses=function(){"undefined"!=typeof this.content.activateCarousel&&!0==this.content.activateCarousel&&($("#featuredCourses").owlCarousel({loop:!0,nav:!1,center:!1,slideBy:"page",autoplay:!0,autoWidth:!1,responsiveRefreshRate:50,responsive:{300:{items:1},600:{items:2},1200:{items:3},1500:{items:4}}}),$(".landing-featured-courses .owl-controls__prev").on("click",function(){$("#featuredCourses").trigger("prev.owl.carousel")}),$(".landing-featured-courses .owl-controls__next").on("click",function(){$("#featuredCourses").trigger("next.owl.carousel")}))},this.getTestimonials=function(){var a=$.Deferred();return $.get("https://staticcontent.knowledgecity.com/templates/ussite/1.0/json/en-testimonials--v"+config.LocalStorageStamp+".json",function(b){var c={};c.testimonials=b.map(function(a){a.image=a.image.split(".").join("--v"+config.LocalStorageStamp+".");var b="<div class=\"full-slide-wrapper\"><div class=\"dot slideshow-dot fade ";return"undefined"!=typeof a.class&&(b+=a.class),b+="\" style=\"background-image:url(https://staticcontent.knowledgecity.com/templates/ussite/1.0/images/clients/testimonials/"+a.image+")\"></div><div class=\"slide-wrapper fade\"><div class=\"slide-content-wrapper\"><div class=\"slide-text\">\""+a.text+"\"</div><div class=\"slide-owner-wrapper\"><div class=\"slide-owner\">"+a.name+"</div><div class=\"slide-owner-info\">"+a.title,"undefined"!=typeof a.company&&(b+=" | "+a.company),b+="</div></div></div></div></div>",{testimonial:b}}),a.resolve(c)}),a},this.setAnalyticsCode=function(){var a="";return this.isThankPage&&"undefined"!=typeof this.content.conversionCode&&(a+="<script async src=\"https://www.googletagmanager.com/gtag/js?id="+this.content.conversionCode+"\"></script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '"+this.content.conversionCode+"'); </script>"),"undefined"!=typeof this.content.analyticsCode&&(a+="<script async src=\"https://www.googletagmanager.com/gtag/js?id="+this.content.analyticsCode+"\"></script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '"+this.content.analyticsCode+"');</script>"),this.isThankPage&&"undefined"!=typeof this.content.conversionTag&&(a+="<script> gtag('event', 'conversion', {'send_to': '"+this.content.conversionCode+"/"+this.content.conversionTag+"'}); </script>"),"undefined"!=typeof this.content.isFacebookPixel&&!0==this.content.isFacebookPixel&&(a+="<!-- Facebook Pixel Code --><script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init', '1926496504263076');fbq('track', 'PageView');</script><noscript><img height=\"1\" width=\"1\"src=\"https://www.facebook.com/tr?id=1926496504263076&ev=PageView&noscript=1\"/></noscript><!-- End Facebook Pixel Code -->"),this.isThankPage&&"undefined"!=typeof this.content.bingCode&&(a+="<script defer>(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:\""+this.content.bingCode+"\"};o.q=w[u],w[u]=new UET(o),w[u].push(\"pageLoad\")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!==\"loaded\"&&s!==\"complete\"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,\"script\",\"//bat.bing.com/bat.js\",\"uetq\");</script>"),"undefined"!=typeof this.content.gtagCode&&(a+="<script defer src=\"https://www.googletagmanager.com/gtag/js?id="+this.content.gtagCode+"\"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', '"+this.content.gtagCode+"');</script>"),a},this.setMetaData=function(){var a="";return"undefined"!=typeof this.content.meta&&$.each(this.content.meta,function(b,c){a+="<meta name=\""+b+"\" content=\""+c+"\">"}),a},this.setStyles=function(){var a="";return"corptraining"==this.tmpl&&(a+="<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"integrity=\"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin=\"anonymous\" />"),a+="<link rel=\"stylesheet\" href=\"/"+this.basePath+"/"+this.tmpl+"/css/style.min.css\" /><link rel=\"stylesheet\" href=\"/"+this.basePath+"/"+this.tmpl+"/css/responsive.min.css\" />",a},this.getParam=function(a){var b=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search);return b&&decodeURIComponent(b[1].replace(/\+/g," "))},this.getExpiryRecord=function(a){var b=new Date().getTime()+7776000000;return{value:a,expiryDate:b}},this.addGclid=function(){var b,c=a.getParam("gclid"),d=null,e=a.getParam("gclsrc"),f=!e||-1!==e.indexOf("aw");["gclid_field"].forEach(function(a){document.getElementById(a)&&(b=document.getElementById(a))}),c&&f&&(d=a.getExpiryRecord(c),localStorage.setItem("gclid",JSON.stringify(d)));var g=d||JSON.parse(localStorage.getItem("gclid")),h=g&&new Date().getTime()<g.expiryDate;b&&h&&(b.value=g.value)},this.setOfflineConversionTracking=function(){var b=$.Deferred();return a.addGclid(),b.resolve({}),b}}
